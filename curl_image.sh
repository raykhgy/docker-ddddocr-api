#!/bin/bash

# 定義變數
CAPTCHA_URL="https://lgt.ainja777.com/captcha-handler?get=image&c=backstagecaptcha&t=3eb698d1c191f026f39afb03b4770eaf"
# CAPTCHA_URL="https://sso.fafafa3388.com/rucaptcha/?t=1749875421362"
# CAPTCHA_URL="data:image/png;base64,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"
CAPTCHA_FILE="/tmp/captcha.png"
OCR_API="http://localhost:9999/ocr_image"

# 下載驗證碼圖片
echo "下載驗證碼圖片..."
curl -s -o "$CAPTCHA_FILE" "$CAPTCHA_URL"

# 檢查圖片是否下載成功
if [ ! -f "$CAPTCHA_FILE" ]; then
    echo "錯誤：無法下載驗證碼圖片"
    exit 1
fi

# 確認圖片格式
file "$CAPTCHA_FILE"

# 傳送圖片給 OCR API
echo "傳送圖片給 OCR API..."
curl -X POST -F "image=@$CAPTCHA_FILE" "$OCR_API"

# 清理臨時檔案
rm -f "$CAPTCHA_FILE"
echo "已清理臨時檔案"